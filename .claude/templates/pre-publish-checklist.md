# Pre-Publish Cleanup Checklist

Use this checklist before pushing code to a public repository or releasing a new version.

---

## 1. Code Quality

### Tests
- [ ] All tests pass: `pytest tests/ -v`
- [ ] No skipped tests without documented reason
- [ ] Coverage is acceptable: `pytest --cov=src --cov-report=term-missing`

### Linting & Formatting
- [ ] Code formatted: `black .` or `ruff format .`
- [ ] Linting clean: `ruff check .` or `flake8 src/`
- [ ] Type checking: `mypy src/` (if using types)
- [ ] Import sorting: `isort .`

### Dead Code
- [ ] Dead code scan: `vulture src/ --min-confidence 80`
- [ ] Remove unused imports
- [ ] Remove commented-out code (git remembers)

---

## 2. Security

### Secrets Scan
- [ ] No hardcoded secrets: `git diff --name-only | xargs grep -l "API_KEY\|SECRET\|PASSWORD" || echo "Clean"`
- [ ] No `.env` files committed
- [ ] `.gitignore` includes: `.env*`, `*.pem`, `*.key`, `secrets/`

### Dependency Audit
- [ ] Python: `pip-audit` or `safety check`
- [ ] Node: `npm audit`
- [ ] No CRITICAL or HIGH vulnerabilities (or documented exceptions)

### Code Review
- [ ] Auth endpoints reviewed
- [ ] Input validation present
- [ ] SQL queries parameterized
- [ ] No `eval()` or `exec()` with user input

---

## 3. Documentation

### README
- [ ] Accurately describes current functionality
- [ ] Examples work (copy-paste tested)
- [ ] Installation instructions are current
- [ ] No references to old/removed features
- [ ] Screenshots/GIFs are up-to-date

### Code Comments
- [ ] Public functions have docstrings
- [ ] Complex logic has "why" comments
- [ ] No AI attribution comments ("Generated by Claude")
- [ ] No TODO/FIXME (fix or create issues)

### Changelog
- [ ] CHANGELOG.md updated with new version
- [ ] Follows Keep a Changelog format
- [ ] Breaking changes clearly marked

---

## 4. Git Hygiene

### History
- [ ] No sensitive data in git history (use git-filter-repo if needed)
- [ ] Commit messages are descriptive
- [ ] No "WIP" or "fix" commits (squash if needed)

### .gitignore
- [ ] IDE files: `.idea/`, `.vscode/`, `*.swp`
- [ ] OS files: `.DS_Store`, `Thumbs.db`
- [ ] Build artifacts: `dist/`, `build/`, `*.egg-info/`
- [ ] Virtual envs: `.venv/`, `venv/`, `env/`
- [ ] Cache: `__pycache__/`, `.pytest_cache/`, `.mypy_cache/`
- [ ] Logs: `*.log`, `logs/`
- [ ] Local config: `.env`, `*.local.*`

### Branches
- [ ] Working on correct branch (not pushing to main accidentally)
- [ ] Branch is up-to-date with main: `git rebase origin/main`

---

## 5. Naming & Branding

### File Names
- [ ] Follow consistent convention (snake_case, kebab-case, etc.)
- [ ] No spaces in filenames
- [ ] No legacy names from previous iterations

### Project References
- [ ] All references use current project name
- [ ] Package name matches repo name
- [ ] No references to old names in:
  - [ ] README
  - [ ] Code comments
  - [ ] Error messages
  - [ ] Config files

---

## 6. Files to Include

- [ ] `README.md`
- [ ] `LICENSE`
- [ ] `CHANGELOG.md`
- [ ] `CONTRIBUTING.md` (if accepting contributions)
- [ ] `.gitignore`
- [ ] `pyproject.toml` or `package.json`
- [ ] Source code (`src/` or package directory)
- [ ] Tests (`tests/`)

---

## 7. Files to Exclude

Verify these are in `.gitignore` and not staged:

- [ ] Virtual environments (`.venv/`)
- [ ] Node modules (`node_modules/`)
- [ ] Build artifacts (`dist/`, `build/`)
- [ ] IDE settings (`.idea/`, `.vscode/`)
- [ ] OS files (`.DS_Store`)
- [ ] Secrets and credentials (`.env`, keys)
- [ ] Large binary files (unless intentional)
- [ ] Temporary files (`*.tmp`, `*.bak`)

Check with:
```bash
git status --porcelain | grep "^??" | head -20
```

---

## 8. Final Verification

### Manual Test
- [ ] Fresh clone test: Clone to new directory, follow README, verify it works
- [ ] Happy path works
- [ ] Error handling works (try invalid input)

### Smoke Test Commands
```bash
# Python project
python -c "import mypackage; print(mypackage.__version__)"
mypackage --help
mypackage --dry-run /test/path

# Web project
npm start  # or python run_web.py
curl http://localhost:8000/api/health
```

### Human Checkpoint
- [ ] Reviewed git diff: `git diff main --stat`
- [ ] Confident this is ready for public eyes
- [ ] Created snapshot/tag of current state

---

## 9. Publish

```bash
# Final commit
git add -A
git status  # Review one more time
git commit -m "Release v1.0.0: [brief description]"

# Tag
git tag v1.0.0
git push origin main --tags

# If publishing to package registry
# Python: twine upload dist/*
# Node: npm publish
```

---

## Quick Reference Commands

```bash
# Full quality check
black . && ruff check . && mypy src/ && pytest tests/ -v

# Security check
pip-audit && git diff --name-only | xargs grep -l "SECRET\|KEY\|PASSWORD" || echo "Clean"

# Dead code check
vulture src/ --min-confidence 80

# Pre-push diff review
git diff main --stat
git log main..HEAD --oneline
```
